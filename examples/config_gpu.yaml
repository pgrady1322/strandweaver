# StrandWeaver Configuration - GPU Accelerated
# Maximum performance with GPU acceleration and all AI models

# ============================================================================
# AI/ML Settings (ALL ENABLED)
# ============================================================================
ai:
  enabled: true
  use_classical_fallback: true
  
  correction:
    adaptive_kmer:
      enabled: true
      model_path: null
      min_confidence: 0.7
    base_error_classifier:
      enabled: true
      model_path: null
      min_confidence: 0.8
  
  assembly:
    edge_ai:
      enabled: true
      model_path: null
      edge_threshold: 0.5
    path_gnn:
      enabled: true
      model_path: null
      min_path_score: 0.6
    diploid_ai:
      enabled: true
      model_path: null
      phase_confidence: 0.7
    ul_routing_ai:
      enabled: true
      model_path: null
      anchor_threshold: 0.6
    sv_ai:
      enabled: true
      model_path: null
      sv_confidence: 0.75
  
  claude:
    enabled: false

# ============================================================================
# Hardware Settings (GPU ENABLED)
# ============================================================================
hardware:
  use_gpu: true  # GPU acceleration enabled
  gpu_device: 0
  threads: 32  # High thread count for CPU operations
  memory_limit_gb: 128  # Large memory for big assemblies

# ============================================================================
# Pipeline Control
# ============================================================================
pipeline:
  steps:
    - profile
    - correct
    - assemble
    - finish
  checkpoint_interval: per_step

# ============================================================================
# Error Profiling (Large sample for accuracy)
# ============================================================================
profiling:
  sample_size: 500000  # Larger sample with GPU
  technology_detection:
    enabled: true
    confidence_threshold: 0.8
  ancient_dna:
    detect_damage: true

# ============================================================================
# Error Correction (Aggressive with GPU)
# ============================================================================
correction:
  illumina:
    kmer_size: 31
    min_kmer_count: 2
    error_rate: 0.01
    use_ai_kmer_selection: true
  
  ont:
    error_rate: 0.10
    homopolymer_correction: true
    use_ai_error_model: true
  
  pacbio:
    error_rate: 0.01
    use_ai_error_model: true
  
  max_iterations: 5  # More iterations with GPU speed
  convergence_threshold: 0.0001  # Tighter convergence

# ============================================================================
# Assembly (All AI features)
# ============================================================================
assembly:
  graph:
    type: auto
    kmer_size: null
    min_overlap: 50
    min_coverage: 2
    use_edge_ai: true
  
  olc:
    enabled: auto
    min_overlap_length: 40
    min_identity: 0.95
  
  dbg:
    enabled: true
    adaptive_k: true
    k_range: [21, 255]  # Extended range with GPU
    k_step: 10
    coverage_cutoff: auto
    use_path_gnn: true
  
  string_graph:
    enabled: auto
    min_read_length: 50000
    use_ul_routing_ai: true
  
  diploid:
    mode: auto
    use_diploid_ai: true
    min_allele_frequency: 0.20  # Lower threshold with GPU
  
  sv_detection:
    enabled: true
    use_sv_ai: true
    min_sv_size: 50
  
  contigs:
    min_length: 500
    min_coverage: 2
    quality_threshold: 20

# ============================================================================
# Scaffolding
# ============================================================================
scaffolding:
  enabled: auto
  hic:
    enabled: false
    min_mapq: 30
    contact_threshold: 5
    resolution: 5000  # Higher resolution with GPU
  ultralong:
    enabled: auto
    min_read_length: 50000
    min_anchors: 2

# ============================================================================
# Finishing
# ============================================================================
finishing:
  enabled: true
  gap_filling:
    enabled: true
    max_gap_size: 10000
  polishing:
    enabled: true
    rounds: 3
    use_original_reads: true
  decontamination:
    enabled: false

# ============================================================================
# Output
# ============================================================================
output:
  format: fasta
  compression: gzip
  include_quality: true
  include_metadata: true
  visualization:
    generate_bandage_files: true
    graph_format: gfa
  logging:
    level: DEBUG  # Detailed logging for performance tuning
    log_file: strandweaver.log
