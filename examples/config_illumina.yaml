# StrandWeaver Configuration - Illumina Reads
# Default settings optimized for Illumina short-read assembly

# ============================================================================
# AI/ML Settings (DEFAULT: ENABLED)
# ============================================================================
ai:
  enabled: true  # Use ML/AI models by default
  use_classical_fallback: true  # Fall back to heuristics if model fails
  
  # Error Correction AI
  correction:
    adaptive_kmer:
      enabled: true
      model_path: null  # Auto-detect from installation
      min_confidence: 0.7
    base_error_classifier:
      enabled: true
      model_path: null
      min_confidence: 0.8
  
  # Assembly AI Models
  assembly:
    edge_ai:
      enabled: true
      model_path: null
      edge_threshold: 0.5
    path_gnn:
      enabled: true
      model_path: null
      min_path_score: 0.6
    diploid_ai:
      enabled: true
      model_path: null
      phase_confidence: 0.7
    ul_routing_ai:
      enabled: false  # Not needed for Illumina
      model_path: null
    sv_ai:
      enabled: true
      model_path: null
      sv_confidence: 0.75
  
  # Claude API (experimental)
  claude:
    enabled: false
    api_key: null
    model: claude-3-opus-20240229
    use_for_finishing: false

# ============================================================================
# Hardware Settings (DEFAULT: CPU)
# ============================================================================
hardware:
  use_gpu: false  # CPU by default
  gpu_device: 0
  threads: null  # Auto-detect
  memory_limit_gb: null

# ============================================================================
# Pipeline Control
# ============================================================================
pipeline:
  steps:
    - profile
    - correct
    - assemble
    - finish
  skip_profiling: false
  skip_correction: false
  resume: false
  checkpoint_interval: per_step
  checkpoint_dir: null

# ============================================================================
# Error Profiling
# ============================================================================
profiling:
  sample_size: 100000
  min_quality: 0
  technology_detection:
    enabled: true
    confidence_threshold: 0.8
  ancient_dna:
    detect_damage: false  # Not ancient DNA
    ct_threshold: 0.05
    ga_threshold: 0.05

# ============================================================================
# Error Correction
# ============================================================================
correction:
  illumina:
    kmer_size: 31
    min_kmer_count: 2
    error_rate: 0.01
    use_ai_kmer_selection: true
  
  # Multi-pass correction
  max_iterations: 3
  convergence_threshold: 0.001

# ============================================================================
# Assembly
# ============================================================================
assembly:
  # Graph construction
  graph:
    type: dbg  # De Bruijn graph for Illumina
    kmer_size: null  # Auto-select with AI
    min_overlap: 50
    min_coverage: 2
    use_edge_ai: true
  
  # Overlap Layout Consensus
  olc:
    enabled: true  # Build artificial long reads
    min_overlap_length: 40
    min_identity: 0.95
    max_overhang: 10
  
  # De Bruijn Graph
  dbg:
    enabled: true
    adaptive_k: true
    k_range: [21, 127]
    k_step: 10
    coverage_cutoff: auto
    use_path_gnn: true
  
  # String Graph (not needed for Illumina)
  string_graph:
    enabled: false
  
  # Diploid Assembly
  diploid:
    mode: auto
    use_diploid_ai: true
    min_allele_frequency: 0.25
  
  # SV Detection
  sv_detection:
    enabled: true
    use_sv_ai: true
    min_sv_size: 50
    max_sv_size: 1000000
  
  # Contig building
  contigs:
    min_length: 500
    min_coverage: 2
    quality_threshold: 20

# ============================================================================
# Scaffolding
# ============================================================================
scaffolding:
  enabled: auto
  hic:
    enabled: false
    min_mapq: 30
    contact_threshold: 5
    resolution: 10000

# ============================================================================
# Finishing
# ============================================================================
finishing:
  enabled: true
  gap_filling:
    enabled: true
    max_gap_size: 10000
    min_overlap_to_gap: 100
  polishing:
    enabled: true
    rounds: 2
    use_original_reads: true
  decontamination:
    enabled: false
    reference_databases: []

# ============================================================================
# Output
# ============================================================================
output:
  format: fasta
  compression: gzip
  include_quality: true
  include_metadata: true
  visualization:
    generate_bandage_files: true
    graph_format: gfa
  logging:
    level: INFO
    log_file: strandweaver.log
