# StrandWeaver Configuration - Ancient DNA
# Optimized for damaged ancient DNA with C->T and G->A deamination

# ============================================================================
# AI/ML Settings (DEFAULT: ENABLED)
# ============================================================================
ai:
  enabled: true
  use_classical_fallback: true
  
  correction:
    adaptive_kmer:
      enabled: true
      model_path: null
      min_confidence: 0.7
    base_error_classifier:
      enabled: true  # Critical for damage detection
      model_path: null
      min_confidence: 0.8
  
  assembly:
    edge_ai:
      enabled: true
      model_path: null
      edge_threshold: 0.5
    path_gnn:
      enabled: true
      model_path: null
      min_path_score: 0.6
    diploid_ai:
      enabled: true
      model_path: null
      phase_confidence: 0.7
    ul_routing_ai:
      enabled: false
    sv_ai:
      enabled: true
      model_path: null
      sv_confidence: 0.75
  
  claude:
    enabled: false

# ============================================================================
# Hardware Settings
# ============================================================================
hardware:
  use_gpu: false
  threads: null
  memory_limit_gb: null

# ============================================================================
# Pipeline Control
# ============================================================================
pipeline:
  steps:
    - profile
    - correct
    - assemble
    - finish
  checkpoint_interval: per_step

# ============================================================================
# Error Profiling (CRITICAL for ancient DNA)
# ============================================================================
profiling:
  sample_size: 100000
  min_quality: 0
  technology_detection:
    enabled: true
    confidence_threshold: 0.8
  ancient_dna:
    detect_damage: true  # MUST detect damage patterns
    ct_threshold: 0.05
    ga_threshold: 0.05

# ============================================================================
# Error Correction (Ancient DNA specific)
# ============================================================================
correction:
  illumina:
    kmer_size: 31
    min_kmer_count: 2
    error_rate: 0.01
    use_ai_kmer_selection: true
  
  ancient_dna:
    damage_correction: true
    deamination_mode: ai  # Use AI for damage classification
    use_ai_damage_classifier: true
    trim_ends: true  # Trim damaged ends
    trim_length: 5
  
  max_iterations: 3
  convergence_threshold: 0.001

# ============================================================================
# Assembly
# ============================================================================
assembly:
  graph:
    type: dbg
    kmer_size: null
    min_overlap: 50
    min_coverage: 2  # Lower for ancient DNA (low coverage)
    use_edge_ai: true
  
  olc:
    enabled: true
    min_overlap_length: 40
    min_identity: 0.90  # Lower for damaged DNA
    max_overhang: 15
  
  dbg:
    enabled: true
    adaptive_k: true
    k_range: [21, 127]
    k_step: 10
    coverage_cutoff: auto
    use_path_gnn: true
  
  string_graph:
    enabled: false
  
  diploid:
    mode: haploid  # Ancient DNA often haploid
    use_diploid_ai: false
  
  sv_detection:
    enabled: true
    use_sv_ai: true
    min_sv_size: 50
  
  contigs:
    min_length: 200  # Lower minimum for ancient DNA
    min_coverage: 1  # Accept low coverage
    quality_threshold: 15

# ============================================================================
# Scaffolding
# ============================================================================
scaffolding:
  enabled: false  # Usually not available for ancient DNA

# ============================================================================
# Finishing
# ============================================================================
finishing:
  enabled: true
  gap_filling:
    enabled: true
    max_gap_size: 10000
  polishing:
    enabled: true
    rounds: 2
  decontamination:
    enabled: true  # Important for ancient DNA
    reference_databases:
      - /path/to/modern_contaminants.fasta
      - /path/to/soil_microbes.fasta

# ============================================================================
# Output
# ============================================================================
output:
  format: fasta
  compression: gzip
  include_quality: true
  include_metadata: true
  visualization:
    generate_bandage_files: true
    graph_format: gfa
  logging:
    level: INFO
    log_file: strandweaver.log
